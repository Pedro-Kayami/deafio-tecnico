# ğŸš€ Desafio TÃ©cnico Backend - Green Acesso

Este projeto tem como objetivo a importaÃ§Ã£o e gestÃ£o de boletos em um sistema de portaria condominial, integrando arquivos `.csv` e `.pdf`, com exportaÃ§Ã£o de relatÃ³rios em PDF.

---

## â™»ï¸ Tecnologias
- Node.js + TypeScript
- Express
- MySQL
- PDF-lib / PDFKit
- Multer (upload de arquivos)
- csv-parser (leitura de arquivos CSV)

---

## âš–ï¸ Estrutura do Projeto
```
src/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ BoletoController.ts
â”œâ”€â”€ database/
â”‚   â””â”€â”€ connection.ts
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ boleto.routes.ts
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ request/
â”‚   â”‚   â””â”€â”€ CreateBoletoRequest.ts
â”‚   â””â”€â”€ response/
â”‚       â”œâ”€â”€ CreateBoletoResponse.ts
â”‚       â””â”€â”€ ListBoletosResponse.ts
â”œâ”€â”€ usecase/
â”‚   â”œâ”€â”€ CreateBoletoUseCase.ts
â”‚   â”œâ”€â”€ ListBoletosUseCase.ts
â”‚   â”œâ”€â”€ ImportPdfBoletosUseCase.ts
â”‚   â””â”€â”€ InitDatabaseUseCase.ts
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ gerarPdfFake.ts
â”œâ”€â”€ index.ts
```

---

## âš™ï¸ Setup

### 1. Instalar dependÃªncias
```bash
npm install
```

### 2. Rodar o projeto
```bash
npm run dev
```

> Ao iniciar, o projeto cria automaticamente as tabelas `lotes` e `boletos` no banco.

---

## ğŸ”— Endpoints

### âœ‰ ImportaÃ§Ã£o de boletos via CSV
```http
POST /api/importar-boletos
```
- Enviar via `form-data`
- Campo: `arquivo` (tipo: File)
- Formato esperado:
```csv
nome;unidade;valor;linha_digitavel
JOSE DA SILVA;17;182.54;123456123456123456
```

---

### ğŸ”¹ ImportaÃ§Ã£o de PDF paginado (1 por boleto)
```http
POST /api/importar-pdf
```
- Enviar via `form-data`
- Campo: `arquivo` (tipo: File)
- PDF deve conter uma pÃ¡gina por boleto, na mesma ordem de inserÃ§Ã£o
- Resultado: arquivos individuais salvos na pasta `/boletos-pdf/{id}.pdf`

---

### ğŸ“ƒ Listagem de boletos com filtros
```http
GET /api/boletos
```
Filtros:
- `nome`
- `id_lote`
- `valor_inicial`
- `valor_final`

Exemplo:
```
/api/boletos?nome=JOSE&id_lote=1&valor_inicial=100&valor_final=500
```

---

### ğŸ“„ GeraÃ§Ã£o de relatÃ³rio PDF (em base64)
```http
GET /api/boletos?relatorio=1
```
Retorna:
```json
{
  "base64": "JVBERi0xLjQKJ..."
}
```
- Tabela com ID, nome, valor, lote e linha digitÃ¡vel

---

## ğŸ¨ GeraÃ§Ã£o de PDF fake para testes
```bash
npm run gerar-pdf-fake
```
- Gera 3 pÃ¡ginas com nomes fictÃ­cios em `uploads/pdf_fake_boletos.pdf`

---

## ğŸ“ Pastas importantes
```
uploads/         # arquivos temporÃ¡rios recebidos
boletos-pdf/     # PDFs divididos por boleto (ex: 1.pdf, 2.pdf)
```

---

## ğŸ“š ObservaÃ§Ãµes
- O nome da unidade Ã© convertido automaticamente para o padrÃ£o de 4 dÃ­gitos (ex: 17 â†’ 0017)
- Os boletos inseridos em CSV sÃ£o vinculados automaticamente aos seus lotes
- O PDF Ã© dividido em pÃ¡ginas com nomes baseados no ID de cada boleto

---

Desenvolvido por Pedro Scarpin para o desafio tÃ©cnico da Green Acesso. ğŸš€

